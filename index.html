<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEON STORM MOBILE</title>
    <style>
        body {
            margin: 0;
            background-color: #080808;
            overflow: hidden;
            touch-action: none; /* Telefondaki kaydırmayı engeller */
            font-family: 'Arial', sans-serif;
        }
        canvas {
            display: block;
        }
        #ui {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
            pointer-events: none;
            z-index: 10;
        }
        h1 {
            font-size: 40px;
            margin: 0;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
            letter-spacing: 2px;
        }
        p {
            font-size: 16px;
            color: #aaa;
            margin-top: 10px;
        }
        #score-board {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-size: 24px;
            font-weight: bold;
            pointer-events: none;
            text-shadow: 0 0 10px white;
            display: none;
        }
    </style>
</head>
<body>

    <div id="score-board">SKOR: <span id="scoreVal">0</span></div>

    <div id="ui">
        <h1>NEON STORM</h1>
        <p>BAŞLAMAK İÇİN EKRANA DOKUN</p>
    </div>

    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const ui = document.getElementById('ui');
        const scoreBoard = document.getElementById('score-board');
        const scoreVal = document.getElementById('scoreVal');

        let width, height;
        let particles = [];
        let enemies = [];
        let player = { x: 0, y: 0, active: false, trail: [] };
        let score = 0;
        let gameActive = false;
        let animationId;
        let frame = 0;

        // Renk Paleti (Neon)
        const colors = ['#FF0055', '#00FFCC', '#FFFF00', '#BD00FF'];

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // --- FİZİK MOTORU ---

        class Particle {
            constructor(x, y, color, speed) {
                this.x = x;
                this.y = y;
                this.color = color;
                const angle = Math.random() * Math.PI * 2;
                const velocity = Math.random() * speed;
                this.vx = Math.cos(angle) * velocity;
                this.vy = Math.sin(angle) * velocity;
                this.life = 1.0;
                this.decay = Math.random() * 0.03 + 0.01;
            }
            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.life -= this.decay;
                // Sürtünme
                this.vx *= 0.95;
                this.vy *= 0.95;
            }
            draw() {
                ctx.globalAlpha = this.life;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.globalAlpha = 1.0;
            }
        }

        class Enemy {
            constructor() {
                const side = Math.floor(Math.random() * 4);
                if (side === 0) { this.x = Math.random() * width; this.y = -50; } // Üst
                else if (side === 1) { this.x = width + 50; this.y = Math.random() * height; } // Sağ
                else if (side === 2) { this.x = Math.random() * width; this.y = height + 50; } // Alt
                else { this.x = -50; this.y = Math.random() * height; } // Sol

                this.angle = Math.atan2(player.y - this.y, player.x - this.x);
                this.speed = 2 + (score / 500); // Zorluk artışı
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;
                this.radius = 10 + Math.random() * 10;
                this.color = colors[Math.floor(Math.random() * colors.length)];
                this.history = [];
            }
            update() {
                // Oyuncuyu takip et (hafif kavisli)
                const dx = player.x - this.x;
                const dy = player.y - this.y;
                const angle = Math.atan2(dy, dx);
                
                this.vx += Math.cos(angle) * 0.1;
                this.vy += Math.sin(angle) * 0.1;
                
                // Hız limiti
                const speed = Math.sqrt(this.vx*this.vx + this.vy*this.vy);
                if(speed > this.speed + 2) {
                    this.vx *= 0.95;
                    this.vy *= 0.95;
                }

                this.x += this.vx;
                this.y += this.vy;

                // İz efekti için geçmiş pozisyon
                this.history.push({x: this.x, y: this.y});
                if(this.history.length > 10) this.history.shift();
            }
            draw() {
                // Düşman İzi
                ctx.beginPath();
                ctx.strokeStyle = this.color;
                ctx.lineWidth = 2;
                for(let i=0; i<this.history.length; i++) {
                    ctx.lineTo(this.history[i].x, this.history[i].y);
                }
                ctx.stroke();

                // Düşman Gövdesi
                ctx.shadowBlur = 20;
                ctx.shadowColor = this.color;
                ctx.fillStyle = '#fff';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
                ctx.fill();
                ctx.shadowBlur = 0;
            }
        }

        function createExplosion(x, y, color) {
            for(let i=0; i<15; i++) {
                particles.push(new Particle(x, y, color, 8));
            }
        }

        function gameOver() {
            gameActive = false;
            ui.style.display = 'block';
            ui.innerHTML = `<h1>OYUN BİTTİ</h1><p>SKORUN: ${score}</p><p>TEKRAR DOKUN</p>`;
            scoreBoard.style.display = 'none';
            createExplosion(player.x, player.y, '#fff');
            
            // Şok dalgası efekti (basit)
            document.body.style.backgroundColor = "#330000";
            setTimeout(() => document.body.style.backgroundColor = "#080808", 100);
        }

        function loop() {
            if(!gameActive && particles.length === 0) return; // Durdur ama patlamalar bitsin

            // Ekran Temizleme (İz efekti için şeffaf siyah)
            ctx.fillStyle = 'rgba(8, 8, 8, 0.2)';
            ctx.fillRect(0, 0, width, height);

            // Parlama Efekti Modu
            ctx.globalCompositeOperation = 'lighter';

            // Oyuncu Çizimi
            if (gameActive) {
                // Oyuncu İzi (Trail)
                player.trail.push({x: player.x, y: player.y});
                if(player.trail.length > 20) player.trail.shift();

                ctx.beginPath();
                ctx.strokeStyle = '#00ffff';
                ctx.lineWidth = 4;
                ctx.lineCap = 'round';
                for(let i=0; i<player.trail.length; i++){
                    const point = player.trail[i];
                    ctx.lineTo(point.x, point.y);
                }
                ctx.stroke();

                // Oyuncu
                ctx.shadowBlur = 30;
                ctx.shadowColor = '#00ffff';
                ctx.fillStyle = '#ffffff';
                ctx.beginPath();
                ctx.arc(player.x, player.y, 10, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0;

                score++;
                scoreVal.innerText = Math.floor(score/10);
            }

            // Düşmanlar
            if (frame % 20 === 0 && gameActive) enemies.push(new Enemy()); // Düşman sıklığı

            for (let i = enemies.length - 1; i >= 0; i--) {
                let e = enemies[i];
                e.update();
                e.draw();

                // Çarpışma
                const dist = Math.hypot(player.x - e.x, player.y - e.y);
                if (gameActive && dist < e.radius + 10) {
                    gameOver();
                }
                
                // Ekran dışına çıkınca sil (Performans)
                if(e.x < -100 || e.x > width + 100 || e.y < -100 || e.y > height + 100) {
                    enemies.splice(i, 1);
                }
            }

            // Parçacıklar
            for (let i = particles.length - 1; i >= 0; i--) {
                let p = particles[i];
                p.update();
                p.draw();
                if(p.life <= 0) particles.splice(i, 1);
            }

            ctx.globalCompositeOperation = 'source-over'; // Normale dön
            frame++;
            requestAnimationFrame(loop);
        }

        // --- KONTROLLER (TELEFON UYUMLU) ---

        function startGame(e) {
            if(gameActive) return;
            
            // Dokunma veya Tıklama koordinatını al
            const x = e.touches ? e.touches[0].clientX : e.clientX;
            const y = e.touches ? e.touches[0].clientY : e.clientY;

            gameActive = true;
            score = 0;
            enemies = [];
            particles = [];
            player.trail = [];
            player.x = x;
            player.y = y;
            
            ui.style.display = 'none';
            scoreBoard.style.display = 'block';
            loop();
        }

        function movePlayer(e) {
            if(!gameActive) return;
            e.preventDefault(); // Sayfa kaymasını engelle
            
            const x = e.touches ? e.touches[0].clientX : e.clientX;
            const y = e.touches ? e.touches[0].clientY : e.clientY;
            
            // Yumuşak geçiş (Lerp)
            player.x += (x - player.x) * 0.5;
            player.y += (y - player.y) * 0.5;
        }

        // Event Listeners
        window.addEventListener('touchstart', startGame, {passive: false});
        window.addEventListener('mousedown', startGame);
        
        window.addEventListener('touchmove', movePlayer, {passive: false});
        window.addEventListener('mousemove', movePlayer);

    </script>
</body>
</html>
